@using ITS.Infrastructure.Global;
@model ITS.Domain.ViewModels.PatientCaseAndSupplierWithPatientPostCodeViewModel
@using System.Web.Script.Serialization
@{
    ViewBag.Title = "Accep and Refer Screen";
    Layout = "~/Areas/Internal/Views/Shared/_InternalLayout.cshtml";  
}
<link href="@Url.Content("~/Content/accept-reffer-screen.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/viewmodels/areas/internal/shared/InternalTask/AcceptAndReferTriageAssessmentViewModel.js")" type="text/javascript"></script>
<script type="text/javascript">

    $(function () {

        var viewModel = new AcceptAndReferTriageAssessmentViewModel();
        ko.applyBindings(viewModel);
        viewModel.Init(@MvcHtmlString.Create(new JavaScriptSerializer().Serialize(Model)));

    });
</script>
<div id="divAcceptAndReferScreen">
 
    <div id="accept-reffer-screen">
        <div id="heading">
            <strong>Accept and Refer Triage Assessment</strong>
        </div>
        <div class="clear">
        </div>
        <div class="clear">
        </div>
        <div id="pateint-info">
            <div id="left-info">
                <div class="patnt-hdng" style="height: 30px">
                    Patient Case Number:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:CaseNumber"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Title:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:Title"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient First Name:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:FirstName"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Surname:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:LastName"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Address:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:Address"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient City:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:City"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Region:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:Region"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Post Code:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:PostCode"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Referrer Reference Number:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:CaseReferrerReferenceNumber"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Treatment Category:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:TreatmentCategoryName"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Treatment Type:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:TreatmentTypeName"></span>
                </div>
            </div>
            <div id="right-info">
                <div class="patnt-hdng">
                    Patient Home Phone:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:HomePhone"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Work Phone:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:WorkPhone"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Mobile:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:MobilePhone"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Email:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:Email"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient DOI:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:CaseDateOfInquiry"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient DOB:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:BirthDate"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Age:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:Age"></span>
                </div>
                <div class="clear">
                </div>
                <div class="patnt-hdng">
                    Patient Gender:
                </div>
                <div class="patnt-info">
                    <span data-bind="text:Gender"></span>
                </div>
                <div class="clear">
                </div>
            </div>
        </div>
        <div id="view-reff">
            <a href="#" data-bind="attr: { href: ReferralFileDownloadPath}">View Referral</a></div>
        <div class="its--accept-refer-border">
        </div>
        <div class="clear">
        </div>
        <span>Refer to supplier</span>
        <div id="referrer-to-supplier">
            @*<div data-bind="visible:NORecoredFound" style="color: red; font-size: 15px; padding: 20px;">
                There are no Suppliers with the specified Treatment Type for Case. If you feel this
                is an error, please contact your administrator
            </div>*@
            <table align="center" cellpadding="5" cellspacing="0" width="97%" data-bind="visible:ShowGridData">
                <tr>
                    <td class="tdHeading">
                    </td>
                    <td class="tdHeading">
                        Price
                    </td>
                    <td class="tdHeading">
                        Supplier Name
                    </td>
                    <td class="tdHeading">
                        Supplier Address
                    </td>
                    <td class="tdHeading">
                        Supplier Post Code
                    </td>
                    <td class="tdHeading">
                        Supplier Telephone
                    </td>
                    <td class="tdHeading">
                        Select Supplier
                    </td>
                </tr>
                <tbody data-bind="foreach:SupplierTriageArray">
                    <tr>
                        <td class="rows">
                            <span data-bind="text:$index()+1"></span>
                        </td>
                        <td class="rows">
                            <span data-bind="text:Price"></span>
                        </td>
                        <td class="rows">
                            <span data-bind="text:SupplierName"></span>
                        </td>
                        <td class="rows">
                            <span data-bind="text:Address"></span>
                        </td>
                        <td class="rows">
                            <span data-bind="text:PostCode"></span>
                        </td>
                        <td class="rows">
                            <span data-bind="text:Phone"></span>
                        </td>
                        <td class="rows">
                            <input type="radio" name="acceptandrefer"  data-bind="checked:$root.SelectTriageSupplierID,attr:{value:SupplierID}" />
                        </td>
                    </tr>
                </tbody>
            </table>
            <div>
                <br />
                <span>If the Supplier you are looking or is not displayed above, select Triage Supplier
                    from dropdown.</span>
                <table align="center" cellpadding="5" cellspacing="0" width="97%" data-bind="visible:ShowGridData">
                    <tr>
                        <td class="tdHeading">
                            Supplier Name
                        </td>
                        <td class="tdHeading">
                            Price 
                        </td>
                        <td class="tdHeading">
                            Supplier Address
                        </td>
                        <td class="tdHeading">
                            Supplier Post Code
                        </td>
                        <td class="tdHeading">
                            Supplier Telephone
                        </td>
                        <td class="tdHeading">
                            Select Supplier
                        </td>
                    </tr>
                    <tbody>
                        <tr>
                            <td colspan="6">
                                <div style="float: left; width: 120px;" class="rows">
                                    <select style="width: 100px;" id="SupplierTriage" name="SupplierTriage" data-bind="options:TriageSuppliers, optionsText:'SupplierName',value:SelectedTriageSupplier,optionsCaption: 'Choose...'"
                                        required>
                                    </select>
                                </div>
                                <div style="float: left" data-bind="with:SelectedTriageSupplier">
                                    <div class="rows" style="float: left; width: 99px;">
                                        <span data-bind="text:Price"></span>
                                    </div>
                                    <div class="rows" style="float: left; width: 148px;">
                                        <span data-bind="text:Address"></span>
                                    </div>
                                    <div class="rows" style="float: left; width: 161px;">
                                        <span data-bind="text:PostCode"></span>
                                    </div>
                                    <div class="rows" style="float: left; width: 161px;">
                                        <span data-bind="text:Phone"></span>
                                    </div>
                                    <div class="rows" style="float: left; width: 120px">
                                        <input type="radio" data-bind="checked:$root.SelectTriageSupplierID,attr:{value:SupplierID}"
                                            name="acceptandrefer" />
                                            
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="its--accept-refer-border">
        </div>
        <div id="save-submit">
            <input type="submit" data-bind="enable:SubmitToSupplier,click:SubmitTriageAssessmentCaseToSupplier"
                value="Submit to Supplier" />
        </div>
    </div>

    @using (Html.BeginForm(GlobalConst.Actions.FileController.GeneratedPatientReferrerToSupplierLetter, GlobalConst.Controllers.File, new { area = "" }, FormMethod.Post, new { id = "frmGenerateLetters" }))
    {
        @Html.AntiForgeryToken()
        <input type="hidden" name="caseID" data-bind="value: CaseID" />
    }
</div>
